<html xmlns:th="https://www.thymeleaf.org">

<head>
    <meta http-equiv='X-UA-Compatible' content='IE=Edge' />
    <meta charset='UTF-8'>
    <title>Maps SDK for Web - Markers clustering</title>
    <meta name='viewport'
          content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'/>
    <link rel='stylesheet' type='text/css' href='https://api.tomtom.com/maps-sdk-for-web/cdn/5.x/5.41.0/maps/maps.css'>
    <style>
        #map{
            height: 100vh;
            width: 100%;
        }
    </style>
</head>
<body>
<div id='map' class='map'></div>
<script src='https://api.tomtom.com/maps-sdk-for-web/cdn/5.x/5.41.0/maps/maps-web.min.js'></script>
<script>
  var map = window.tt.map({
    key: "KT5Fjv06WL9YWbIw7a9x6ZZp1WxBwGvM",
    container: "map",
    center: [-0.128666, 51.505814],
    zoom: 10
  });
  map.addControl(new window.tt.FullscreenControl());
  map.addControl(new window.tt.NavigationControl());

  var markersOnTheMap = {};
  var eventListenersAdded = false;

  var points = [
    {
      coordinates: [-0.13389631465156526, 51.510387047712356],
      properties: {
        id: 1,
        name: "Checkpoint A"
      }
    },
    {
      coordinates: [-0.11281231063600217, 51.51807866942707],
      properties: {
        id: 2,
        name: "Checkpoint B"
      }
    },
    {
      coordinates: [0.04410606135789408, 51.60606293106869],
      properties: {
        id: 3,
        name: "Checkpoint C"
      }
    },
    {
      coordinates: [0.06813865412814835, 51.6009452260123],
      properties: {
        id: 4,
        name: "Checkpoint D"
      }
    },
    {
      coordinates: [0.05028587092436965, 51.596253489653066],
      properties: {
        id: 5,
        name: "Checkpoint E"
      }
    },
    {
      coordinates: [0.026939923659398346, 51.59412072198555],
      properties: {
        id: 6,
        name: "Checkpoint F"
      }
    },
    {
      coordinates: [0.04822593439902789, 51.58729519243778],
      properties: {
        id: 7,
        name: "Checkpoint G"
      }
    },
    {
      coordinates: [0.0598989080363026, 51.58516200412868],
      properties: {
        id: 8,
        name: "Checkpoint H"
      }
    },
    {
      coordinates: [-0.1484370070708394, 51.51355434335747],
      properties: {
        id: 9,
        name: "Checkpoint I"
      }
    },
    {
      coordinates: [-0.14116666086630403, 51.516268992925035],
      properties: {
        id: 10,
        name: "Checkpoint J"
      }
    },
    {
      coordinates: [-0.14698293783399663, 51.50857706561709],
      properties: {
        id: 11,
        name: "Checkpoint K"
      }
    },
    {
      coordinates: [-0.1389855570008649, 51.512649424212185],
      properties: {
        id: 12,
        name: "Checkpoint L"
      }
    },
    {
      coordinates: [-0.1484370070708394, 51.51581656256633],
      properties: {
        id: 13,
        name: "Checkpoint M"
      }
    },
    {
      coordinates: [-0.1542532840487354, 51.51400679618595],
      properties: {
        id: 14,
        name: "Checkpoint N"
      }
    },
    {
      coordinates: [-0.17024804570488072, 51.516268992925035],
      properties: {
        id: 15,
        name: "Checkpoint O"
      }
    },
    {
      coordinates: [-0.16006956101645642, 51.50857706561709],
      properties: {
        id: 16,
        name: "Checkpoint P"
      }
    }
  ];

  var geoJson = {
    type: "FeatureCollection",
    features: points.map(function(point) {
      return {
        type: "Feature",
        geometry: {
          type: "Point",
          coordinates: point.coordinates
        },
        properties: point.properties
      };
    })
  };

   map.addLayer({
                id: 'clusters',
                type: 'circle',
                source: 'point-source',
                filter: ['has', 'point_count'],
                paint: {
                    'circle-color': [
                        'step',
                        ['get', 'point_count'],
                        '#EC619F',
                        4,
                        '#008D8D',
                        7,
                        '#004B7F'
                    ],
                    'circle-radius': [
                        'step',
                        ['get', 'point_count'],
                        15,
                        4,
                        20,
                        7,
                        25
                    ],
                    'circle-stroke-width': 1,
                    'circle-stroke-color': 'white',
                    'circle-stroke-opacity': 1
                }
            });

  map.on("load", function() {
    map.addSource("point-source", {
      type: "geojson",
      data: geoJson,
      cluster: true,
      clusterMaxZoom: 14,
      clusterRadius: 50
    });
  });
    </script>
</body>
</html>